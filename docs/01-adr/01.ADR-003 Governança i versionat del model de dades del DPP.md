# ADR-003: Governan√ßa i versionat del model de dades del DPP

**Estat:** A confirmar
**Data:** 2026-01-08
**√Ämbit:** Digital Product Passport (DPP) ‚Äì Governan√ßa del model i evoluci√≥
**Decisors:** Arquitectura / Data Governance / Plataforma

---

## 1. Context

El model de dades del DPP est√† basat en una arquitectura per capes on:

* SHACL √©s la font de veritat sem√†ntica,
* JSON Schema √©s una projecci√≥ estructural operativa,
* TypeScript √©s una derivaci√≥ per desenvolupament.

Aquest model nom√©s √©s sostenible si:

* l‚Äôevoluci√≥ √©s controlada,
* els canvis s√≥n tra√ßables,
* i no es permeten desviacions entre artefactes.

Sense una pol√≠tica expl√≠cita de governan√ßa i versionat:

* els esquemes divergeixen,
* apareixen canvis incompatibles sense control,
* i es perd la confian√ßa en el model.

Aquest ADR estableix les regles formals per governar l‚Äôevoluci√≥ del DPP.

---

## 2. Decisi√≥

S‚Äôadopta una **pol√≠tica de governan√ßa centralitzada** del model de dades del DPP, amb les decisions seg√ºents:

### 2.1 Punt √∫nic de modificaci√≥

* **Nom√©s els fitxers SHACL poden ser modificats manualment.**
* JSON Schema i TypeScript s√≥n **artefactes derivats** i no poden editar-se a m√†.
* Qualsevol canvi estructural o sem√†ntic ha d‚Äôoriginar-se en SHACL.

---

### 2.2 Versionat expl√≠cit del model

El model del DPP es versiona de manera expl√≠cita i tra√ßable:

* Cada versi√≥ de SHACL defineix una **versi√≥ del model**.
* Els JSON Schema i tipus TypeScript generats hereten aquesta versi√≥.
* No es permet la publicaci√≥ d‚Äôartefactes sense versi√≥ associada.

El versionat s‚Äôaplica al **model**, no nom√©s al codi.

---

## 3. Pol√≠tica de versionat

### 3.1 Tipus de canvis

Els canvis en SHACL es classifiquen en:

#### üü¢ Canvis compatibles (non-breaking)

* Afegir propietats opcionals
* Afegir noves shapes
* Afegir valors permesos
* Afegir documentaci√≥ o anotacions

#### üî¥ Canvis incompatibles (breaking)

* Eliminar propietats
* Fer obligat√≤ria una propietat existent
* Canviar tipus o cardinalitats
* Canviar el significat sem√†ntic d‚Äôuna propietat
* Reutilitzar una propietat amb un altre sentit

---

### 3.2 Regles de versionat

* **Breaking change** ‚Üí increment de versi√≥ major
* **Non-breaking change** ‚Üí increment de versi√≥ menor
* Canvis purament documentals ‚Üí increment de patch

Aquestes regles s‚Äôapliquen autom√†ticament quan √©s possible i manualment quan cal judici hum√†.

---

## 4. Pipeline de governan√ßa

### 4.1 Proc√©s de canvi

Qualsevol canvi al model segueix aquest flux:

1. Proposta de canvi en SHACL
2. Revisi√≥ sem√†ntica (arquitectura / data)
3. Detecci√≥ autom√†tica de l‚Äôimpacte
4. Assignaci√≥ de tipus de canvi (breaking / non-breaking)
5. Increment de versi√≥
6. Regeneraci√≥ d‚Äôartefactes derivats
7. Publicaci√≥ controlada

---

### 4.2 Tra√ßabilitat

Cada versi√≥ del model ha de tenir associat:

* una descripci√≥ del canvi,
* l‚Äôimpacte esperat,
* els ADRs rellevants,
* i les conseq√º√®ncies conegudes.

Aix√≤ permet entendre **per qu√® el model √©s com √©s**, no nom√©s com √©s.

---

## 5. Motivaci√≥

### 5.1 Evitar diverg√®ncies

Sense governan√ßa, apareixen:

* esquemes ‚Äútocats a m√†‚Äù,
* tipus fora de sincronitzaci√≥,
* solucions locals incompatibles.

Aquest ADR ho prohibeix expl√≠citament.

---

### 5.2 Facilitar l‚Äôevoluci√≥ segura

El DPP est√† destinat a evolucionar:

* noves regulacions,
* nous actors,
* nous casos d‚Äô√∫s.

Una pol√≠tica clara permet evolucionar **sense trencar l‚Äôecosistema**.

---

### 5.3 Responsabilitat compartida

Aquest model estableix que:

* els canvis sem√†ntics s√≥n decisions d‚Äôarquitectura,
* no decisions locals d‚Äôimplementaci√≥.

Aix√≤ protegeix el domini a llarg termini.

---

## 6. Alternatives considerades

### 6.1 Versionar nom√©s JSON Schema

**Descartada** perqu√®:

* perd la sem√†ntica,
* desconnecta el model de l‚Äôontologia,
* converteix SHACL en documentaci√≥ passiva.

---

### 6.2 Permetre modificacions locals

**Descartada** perqu√®:

* introdueix fragmentaci√≥,
* dificulta interoperabilitat,
* genera deute t√®cnic irreversible.

---

### 6.3 Versionat impl√≠cit (sense pol√≠tica)

**Descartada** perqu√®:

* fa invisibles els breaking changes,
* dificulta la coordinaci√≥ entre equips,
* genera errors silenciosos.

---

## 7. Conseq√º√®ncies

### 7.1 Positives

* Evoluci√≥ controlada i tra√ßable.
* Major confian√ßa en el model.
* Menys regressions i errors inesperats.
* Disciplina d‚Äôequip expl√≠cita.
* Facilita auditories i certificacions.

---

### 7.2 Costos i limitacions

* Proc√©s de canvi m√©s rigor√≥s.
* Necessitat de revisi√≥ sem√†ntica.
* Major c√†rrega inicial de governan√ßa.

Aquests costos s√≥n considerats **necessaris i proporcionals** a l‚Äôabast del DPP.

---

## 8. Estat final

La governan√ßa i el versionat del model de dades del DPP es declaren **obligatoris**.
Qualsevol excepci√≥ o desviaci√≥ haur√† de:

* justificar-se expl√≠citament,
* documentar-se,
* i formalitzar-se mitjan√ßant un ADR que modifiqui o substitueixi aquest.

